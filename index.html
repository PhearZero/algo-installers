<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Hello World!</title>
    <link rel="stylesheet" href="node_modules/xterm/css/xterm.css" />
    <script src="node_modules/xterm/lib/xterm.js"></script>
</head>
<body>
<h1>Hello World!</h1>
We are using Node.js <span id="node-version"></span>,
Chromium <span id="chrome-version"></span>,
and Electron <span id="electron-version"></span>.
<a href="http://localhost:3000">Allo</a>
<div id="status"></div>
<script>
    let block = 0
    let options = {
        headers: {
            "X-Algo-API-Token": "741b0de389adf9826609467b23ee7a0b95347018f6ff40c029f2c0548a5075b0",
            // 'Content-Type': 'application/x-www-form-urlencoded',
        },
    }
    function nextBlock(round){
        return fetch(`http://localhost:8080/v2/status/wait-for-block-after/${round}`, options)
    }
    async function loop(){
        let r = await fetch('http://localhost:8080/v2/status', options).then(r=>{
            console.log(r)
            return r.json()
        })
        block = r['last-round']
        document.getElementById("status").innerHTML = `<pre>${JSON.stringify(r, null, 2)}</pre>`
        await nextBlock(block + 1)

        loop()
    }

    loop()
</script>
<div id="terminal"></div>
<script>
    var term = new Terminal();
    term.open(document.getElementById('terminal'));
    term.onKey(({key}) => {
        window.electronAPI.sendMessage(key)
        console.log(key)
    })
    window.electronAPI.handleMessage((event, data)=>{
        // console.log(data)
        term.write(data)
    })
</script>
</body>
</html>
